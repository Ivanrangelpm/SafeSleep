<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SafeSleep | Cadastro</title>
    <link href="./css/style.css" rel="stylesheet" />
    <link href="./css/cadastro.css" rel="stylesheet" />
  </head>

  <body>
    <div class="header">
      <a href="index.html">
        <img src="./images/ssLogoExtended.png" alt="logo" class="logo"/>
      </a>
      <ul class="navbar"> 
        <li><a href="index.html">Início</a></li>
        <li><a href="./calculadoraFinanceira.html">Simulador Financeiro</a></li>
        <li><a href="./sobreNos.html">Sobre Nós</a></li>
        <li><a class="paginaAtual" href="./cadastro.html">Cadastro</a></li>
        <li><a href="./login.html">Login</a></li>
      </ul>
    </div> 
    <div id="div_cadastro" class="main">
      <div class="section cadastro-hospital">
        <h1>CADASTRO</h1>
        <div class="lineForms">
          <div class="line">
            <label>
              <button onclick="changePage1()" id="chgPage1">1</button>
              <span>Hospital</span>
            </label>
            <label>
              <button onclick="changePage2()" id="chgPage2">2</button>
              <span>Representante</span>
            </label>
            <label>
              <button onclick="cadastrar()" id="cadastrar">➜</button>
              <span>Concluir</span>
            </label>
          </div>
        </div>
        <div class="forms">
          <div class="form form1" id="form1">
            <h1>Cadastre seu Hospital</h1>
            <div class="inputs">
              <label>
                <span>Razão Social:<span class="campo_obrigatorio"> *</span></span>
                <input type="text" id="input_razao" placeholder="Razão Social"/>
                <div id="div_erro_razao" class="error"></div>
              </label>
              <label>
                <span>Nome Fantasia:</span>
                <input type="text" id="input_fantasia" placeholder='Nome Fantasia'/>
                <div id="div_erro_fantasia" class="error"></div>
              </label>
              <label>
                <span>CNPJ:<span class="campo_obrigatorio"> *</span></span>
                <input type="number" id="input_cnpj" placeholder="XX.XXX.XXX/XXXX-XX"/>
                <div id="div_erro_cnpj" class="error"></div>
              </label>
              <label>
                <span>E-mail:<span class="campo_obrigatorio"> *</span></span>
                <input type="text" id="input_email" placeholder="E-mail"/>
                <div id="div_erro_email" class="error"></div>
              </label>
              <label>
                <span>Telefone:<span class="campo_obrigatorio"> *</span></span>
                <input type="number" id="input_telefone" placeholder="(xx) xxxx-xxxx"/>
                <div id="div_erro_telefone" class="error"></div>
              </label>
              <label>
                <span>CEP:<span class="campo_obrigatorio"> *</span></span>
                <input type="number" id="input_cep" placeholder="xxxxx-xxx"/>
                <div id="div_erro_cep" class="error"></div>
              </label>
              <label>
                <span>Número:<span class="campo_obrigatorio"> *</span></span>
                <input type="number" id="input_numero" placeholder="Número da Instituição"/>
                <div id="div_erro_numero" class="error"></div>
              </label>
            </div>
          </div>
          <div class="form form2" id="form2">
            <h1>Cadastre-se como Representante</h1>
            <div class="inputs">
              <label>
                <span>Nome:<span class="campo_obrigatorio"> *</span></span>
                <input type="text" id="input_nome" placeholder="Nome"/>
                <div id="div_erro_nome" class="error"></div>
              </label>
              <label>
                <span>Sobrenome:<span class="campo_obrigatorio"> *</span></span>
                <input type="text" id="input_sobrenome" placeholder="Sobrenome"/>
                <div id="div_erro_sobrenome" class="error"></div>
              </label>
              <label>
                <span>E-mail:<span class="campo_obrigatorio"> *</span></span>
                <input type="text" id="input_emailRep" placeholder="E-mail"/>
                <div id="div_erro_emailRep" class="error"></div>
              </label>
              <label>
                <span>CPF:<span class="campo_obrigatorio"> *</span></span>
                <input type="number" id="input_cpf" placeholder="xxx.xxx.xxx-xx"/>
                <div id="div_erro_cpf" class="error"></div>
              </label>
              <label>
                <span>Licença Médica:<span class="campo_obrigatorio"> *</span></span>
                <input type="text" id="input_licenca" placeholder="Licença Médica"/>
                <div id="div_erro_licenca" class="error"></div>
              </label>
              <label>
                <span>Senha:<span class="campo_obrigatorio"> *</span></span>
                <input type="password" id="input_senha" placeholder="Senha"/>
                <div id="div_erro_senha" class="error"></div>
              </label>
              <label>
                <span>Confirme sua senha:<span class="campo_obrigatorio"> *</span></span>
                <input type="password" id="input_confirmar" placeholder="Senha"/>
                <div id="div_erro_confirmar" class="error"></div>
              </label>
              <span id="spanResponse">(A senha deve possuir pelo menos 8 <br> caracteres e um caracter especial)</span>
            </div>
          </div>
          <div id="btn_div">
            <button onclick="changePage2()" class='btn_forms' id="btn_next">Prosseguir</button>
          </div>
          <div class="linkRedirecionar">
            <span>Já possui um usuário? <a href="login.html">Fazer login</a></span>
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <div class="developers">
        <h3>Desenvolvedores da SafeSleep</h3>
        <ul>
          <li>Bruno Yuji Takahashi - bruno.ytakahashi@sptech.school</li>
          <li>Diego Crispim dos Santos Campos - diego.campos@sptech.school</li>
          <li>Fabricio Prudente Ferreira - fabricio.ferreira@sptech.school</li>
          <li>Ivan Rangel Pestana Marcolin - ivan.marcolin@sptech.school</li>
          <li>Lucas Tetsuo Nagasse - lucas.nagasse@sptech.school</li>
          <li>Matheus Yukio Makiyama - matheus.makiyama@sptech.school</li>
          <li>Renan Rocha Pacanaro Trinca - renan.trinca@sptech.school</li>
        </ul>
      </div>
      <div class="contact">
        <h3>Contatos</h3>
        <ul>
          <li>safesleep@gmail.com</li>
          <li>+55 11 99999-9999</li>
        </ul>
        <img src="./images/ssLogoName.png" class="logo" />
      </div>
    </div>
    <div id="alerta" class="divAviso">
      <div class="alertaBox">
        <h1>Falha no Cadastro!</h1>
        <button onclick="closeAlert()">X</button>
      </div>
      <span id="alertText" class='alertaSpan'></span>
    </div>
  </body>
</html>

<script>
  var form1 = document.getElementById('form1');
  var form2 = document.getElementById('form2');
  var btn1 = document.getElementById('chgPage1');
  var btn2 = document.getElementById('chgPage2');

  function changePage1(){
    form1.style.display = 'flex';
    form2.style.display = 'none';
    btn_div.innerHTML = `<button onclick="changePage2()" class='btn_forms' id="btn_next">Prosseguir</button>`;
    btn1.style = 'transform: scale(120%, 120%); background-color: #19A7A8;';

    var nome = input_nome.value;
    var sobrenome = input_sobrenome.value;
    var email_representante = input_emailRep.value;
    var cpf = input_cpf.value;
    var licenca = input_licenca.value;
    var senha = input_senha.value;
    var confirmar = input_confirmar.value;

    if(
      nome == '' || 
      sobrenome == '' ||
      email_representante == '' || 
      cpf == '' || 
      licenca == '' ||
      senha == '' ||
      confirmar == ''
    ) btn2.style = 'transform: scale(100%, 100%); background-color: #61612f;';
    else btn2.style = 'transform: scale(100%, 100%); background-color: #3b536b;';
  }

  function changePage2(){
    form1.style.display = 'none';
    form2.style.display = 'flex';
    btn_div.innerHTML = `<button onclick="cadastrar()" class='btn_forms' id="btn_next">Concluir Cadastro</button>`;
    btn2.style = 'transform: scale(120%, 120%); background-color: #19A7A8;';

    var razao = input_razao.value;
    var cnpj = input_cnpj.value;
    var email = input_email.value;
    var telefone = input_telefone.value;
    var cep = input_cep.value;
    var numero = input_numero.value;

    if(
      razao == '' ||
      cnpj == '' ||
      email == '' ||
      telefone == '' ||
      cep == '' ||
      numero == ''
    ) btn1.style = 'transform: scale(100%, 100%); background-color: #61612f;';
    else btn1.style = 'transform: scale(100%, 100%); background-color: #3b536b;';
  }

  function cadastrar() {
    var razao = input_razao.value;
    var fantasia = input_fantasia.value;
    var cnpj = input_cnpj.value;
    var email = input_email.value;
    var telefone = input_telefone.value;
    var cep = input_cep.value;
    var numero = input_numero.value;
    var nome = input_nome.value;
    var sobrenome = input_sobrenome.value;
    var email_representante = input_emailRep.value;
    var cpf = input_cpf.value;
    var licenca = input_licenca.value;
    var senha = input_senha.value;
    var confirmar = input_confirmar.value;
    var valido = 0;

    var divAlerta = document.getElementById('alerta');

    var corTexto = 'red';
    var tamanhoTexto = '22px';

    var textoAlerta = "";

    if (
      razao == '' ||
      cnpj == '' ||
      email == '' ||
      telefone == '' ||
      cep == '' ||
      numero == '' ||
      nome == '' || 
      sobrenome == '' || 
      email_representante == '' ||
      cpf == '' || 
      licenca == '' ||
      senha == '' ||
      confirmar == ''
    ) {
      alert('É necessário preencher todos os campos obrigatórios!');
    } else {

      //Erro para Razão Social
      if (razao.length <= 1) {
        div_erro_razao.innerHTML = `Razão social inválida`;
        textoAlerta += "- Razão Social<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_razao.innerHTML = "";
        valido++;
      }

      //Erro para CNPJ
      if (cnpj.length != 14 || isNaN(Number(cnpj))) {
        div_erro_cnpj.innerHTML = `CNPJ inválido`;
        textoAlerta += "- CNPJ<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_cnpj.innerHTML = "";
        valido++;
      }

      //Erro para Email
      if (email.indexOf('@') == -1 || email.indexOf(".") == -1) {
        div_erro_email.innerHTML = `E-mail inválido`;
        textoAlerta += "- E-mail do Hospital<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_email.innerHTML = "";
        valido++;
      }

      //Erro para Telefone
      if (telefone.length != 10 || isNaN(Number(telefone))) {
        div_erro_telefone.innerHTML = `Número de telefone inválido`;
        textoAlerta += "- Telefone do Hospital<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_telefone.innerHTML = "";
        valido++;
      }

      //Erro para CEP
      if (cep.length != 8 || isNaN(Number(cep))) {
        div_erro_cep.innerHTML = `CEP Inválido`;
        textoAlerta += "- CEP do Hospital<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_cep.innerHTML = "";
        valido++;
      }

      //Erro para Número
      if (numero.length < 1 || Number(numero) < 1) {
        div_erro_numero.innerHTML = `Número do Enderenço Inválido`;
        textoAlerta += "- Número da Unidade<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_numero.innerHTML = "";
        valido++;
      }

      //Erro para Nome do Representante
      if (nome.length <= 1) {
        div_erro_nome.innerHTML = `Nome Inválido`;
        textoAlerta += "- Nome do Representante<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_nome.innerHTML = "";
        valido++;
      }

      //Erro para Sobrenome do Representante
      if (sobrenome.length <= 1) {
        div_erro_sobrenome.innerHTML = `Sobrenome Inválido`;
        textoAlerta += "- Sobrenome do Representante<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_sobrenome.innerHTML = "";
        valido++;
      }

      // Erro para Email do Representante
      if (email_representante.indexOf('@') == -1 || email_representante.indexOf(".") == -1) {
        div_erro_emailRep.innerHTML = `E-mail inválido`;
        textoAlerta += "- E-mail do Representante<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_emailRep.innerHTML = "";
        valido++;
      }

      //Erro para CPF do Representante
      if (cpf.length != 11 || isNaN(Number(cpf))) {
        div_erro_cpf.innerHTML = `CPF Inválido`;
        textoAlerta += "- CPF do Representante<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_cpf.innerHTML = "";
        valido++;
      }

      //Erro para Licença Médica do Representante
      if (licenca.length <= 1) {
        div_erro_licenca.innerHTML = `Licença Médica Inválida`;
        textoAlerta += "- Licença Médica do Representante<br>";
        divAlerta.style.display = 'flex';
      } else {
        div_erro_licenca.innerHTML = "";
        valido++;
      }

      //Erro para a Senha
      if (
        (senha.indexOf('@') < 0 && 
        senha.indexOf('$') < 0 && 
        senha.indexOf('#') < 0 && 
        senha.indexOf('*') < 0 && 
        senha.indexOf('-') < 0 && 
        senha.indexOf('%') < 0 && 
        senha.indexOf('/') < 0 && 
        senha.indexOf('_') < 0 && 
        senha.indexOf('&') < 0 &&
        senha.indexOf('!') < 0 &&
        senha.indexOf('?') < 0) || 
        senha.length < 8
      ) { // Se não existir caracter especial ou se a senha for curta, avisa que a senha está fraca
        div_erro_senha.innerHTML = `Senha Fraca`;
        textoAlerta += "- Senha";
        divAlerta.style.display = 'flex';
      } 
      else {// Limpando a div senha
        div_erro_senha.innerHTML = "";
        valido++;
        if (senha == confirmar) {
          div_erro_confirmar.innerHTML = "";
          valido++;
        } else {// Mensagem de erro da senha
          div_erro_confirmar.innerHTML = `Senhas não se correspondem`;
          textoAlerta += "- Confirmação de Senha";
          divAlerta.style.display = 'flex';
        }
      }
    }

    alertText.innerHTML = `As seguintes informações não foram validadas pelo sistema:<br>${textoAlerta}`;

    if (valido == 13) {
      div_cadastro.innerHTML = '<h2 class="enviado">Cadastro Concluído!<h2>';  
      div_cadastro.innerHTML += '<br> <a href="./login.html">Fazer Login</a>';
      divAlerta.style.display = 'none';
    }
  }

  //FECHAR O ALERTA EM VERMELHO
  function closeAlert() {
    var divAlert = document.getElementById('alerta');
    divAlert.style.display = 'none';
  }
</script>
